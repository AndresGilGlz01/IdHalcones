<!DOCTYPE html>

<html>
<head>
    <title>ID HALCON</title>
    <meta name="viewport" content="width=device-width" />
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="manifest" href="/manifest.json" />
</head>
<body>
    <script>
        // async function iniciarApp(){
        //     if ('serviceWorker' in navigator) {
        //         await navigator.serviceWorker.register('/serviceworker.js?v=7')
        //             .then(reg => console.log('service worker registrado'))
        //             .catch(err => console.error('Error al registrar el service worker', err));
        //     }
        // }
        // const registerServiceWorker = async () => {
        //     if ("serviceWorker" in navigator) {
        //         try {
        //             const registration = await navigator.serviceWorker.register("/serviceworker.js?v=8");
        //             if (registration.installing) {
        //                 console.log("Instalando el Service worker");
        //             } else if (registration.waiting) {
        //                 console.log("Service worker instalado");
        //             } else if (registration.active) {
        //                 console.log("Service worker activo");

        //             }
        //         } catch (error) {
        //             console.error(`Falló el registro con el ${error}`);
        //         }
        //     }
        // };

        navigator.serviceWorker.register('/serviceworker.js?v=9')
            .then(reg => {
                if (reg.installing) {
                    const sw = reg.installing || reg.waiting;
                    sw.onstatechange = function () {
                        if (sw.state === 'installed') {
                            // SW installed.  Refresh page so SW can respond with SW-enabled page.
                            window.location.reload();
                        }
                    };
                } else if (reg.active) {
                    // something's not right or SW is bypassed.  previously-installed SW should have redirected this request to different page
                    handleError(new Error('Service Worker is installed and not redirecting.'))
                }
            })
            .catch(handleError)

        function handleError(error) { console.log("Falló el registro del servicewoker."); }
        
    </script>
    <main>
        @RenderBody()
    </main>

    
</body>
</html>